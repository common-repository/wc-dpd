(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}window.dpdParcelShopWidget=function(){var t,o,p,d,a,n,r,i,c,l,u,s,h,g,y,v,m,_=!1;function w(){p=".js-dpd-parcelshop-map-widget-open-popup-btn",d=".js-dpd-chosen-parcelshop-content",a=".js-dpd-chosen-parcelshop-chosen-parcelshop-text",n=".js-dpd-parcelshop-hidden-parcelshop-id",r=".js-dpd-parcelshop-hidden-parcelshop-pus-id",i=".js-dpd-parcelshop-hidden-parcelshop-name",c=".js-dpd-parcelshop-hidden-parcelshop-street",l=".js-dpd-parcelshop-hidden-parcelshop-city",u=".js-dpd-parcelshop-hidden-parcelshop-zip",s=".js-dpd-parcelshop-hidden-parcelshop-country-code",t=document.querySelector(".js-dpd-parcelshop-map-widget-popup"),document.addEventListener("click",(function(e){e.target.matches(p)&&(e.preventDefault(),(h=document.querySelector(".js-dpd-parcelshop-map-widget-popup-embed"))&&(dpdMapOpenWidgetMapPopupEl=e.target.closest(p),dpdMapOpenWidgetMapPopupEl&&(!function(){if(_)return;var e=h.getAttribute("data-api-key");if(!e)return void console.log("Map Api key is missing");y=JSON.parse(dpdMapOpenWidgetMapPopupEl.getAttribute("data-countries")),allowedCountries=JSON.parse(dpdMapOpenWidgetMapPopupEl.getAttribute("data-allowed-countries")),allowedCountries=allowedCountries.join(","),v=dpdMapOpenWidgetMapPopupEl.getAttribute("data-base-country-code"),o=new DpdPudo.Widget({apiKey:e,country:v,allowedCountries:[allowedCountries]}),_=!0}(),b())))}),!1),document.addEventListener("click",(function(e){e.target.matches(".js-dpd-parcelshop-map-widget-popup-container")&&(e.preventDefault(),P())}),!1),document.addEventListener("keydown",(function(e){"Escape"===e.key&&P()}),!1),document.addEventListener("change",(function(e){e.target&&e.target.matches('input[name="payment_method"]')&&""!==document.querySelector(n).value&&document.body.dispatchEvent(new Event("update_checkout"))}),!1)}function f(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o&&0!==Object.keys(o).length){var p=o.hasOwnProperty("id")?o.id:null,h=o.hasOwnProperty("id")?o.id:null,g=o.hasOwnProperty("name")?o.name:null,v=o.hasOwnProperty("street")?o.street:null,m=o.hasOwnProperty("zip")?o.zip:null,_=o.hasOwnProperty("city")?o.city:null,w=o.hasOwnProperty("countryCode")?o.countryCode:null;!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"",u=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],s=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=new XMLHttpRequest;h.open("POST",wc_dpd_parcelshop_map_widget_settings.ajax_url,!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.onreadystatechange=function(){var e=4,t=200;h.readyState===e&&h.status===t&&document.body.dispatchEvent(new Event("update_checkout"))},h.send("action=wc_dpd_update_chosen_parcelshop&wp_nonce="+t.getAttribute("data-nonce")+"&wc_dpd_parcelshop_id="+e+"&wc_dpd_parcelshop_pus_id="+o+"&wc_dpd_parcelshop_name="+p+"&wc_dpd_parcelshop_street="+d+"&wc_dpd_parcelshop_zip="+a+"&wc_dpd_parcelshop_city="+n+"&wc_dpd_parcelshop_country_code="+r+"&wc_dpd_parcelshop_max_weight="+i+"&wc_dpd_parcelshop_cod="+c+"&wc_dpd_parcelshop_card="+l+"&wc_dpd_parcelshop_is_alzabox_eligible="+u+"&wc_dpd_parcelshop_is_slovenska_posta_eligible="+s)}(p,h,g,v,m,_,w,o.hasOwnProperty("maxweight")?o.maxweight:null,o.hasOwnProperty("cod")?o.cod:null,o.hasOwnProperty("card")?o.card:null,o.hasOwnProperty("isEligibleForAlzabox")?o.isEligibleForAlzabox:null,o.hasOwnProperty("isEligibleForSlovenskaPostaBox")?o.isEligibleForSlovenskaPostaBox:null);var f=y&&"object"===e(y)&&y.hasOwnProperty(w)?y[w]:w;document.querySelector(n).value=p,document.querySelector(r).value=h,document.querySelector(i).value=g,document.querySelector(c).value=v,document.querySelector(u).value=m,document.querySelector(l).value=_,document.querySelector(s).value=w;var b=Object.values([g,v,m,_,f]).filter((function(e){return!!e}));document.querySelector(a).innerHTML=b.join(", "),document.querySelector(d).classList.add("active")}}function b(){if(t.classList.add("active"),h&&o){var e=document.querySelector(n).value;e&&(o.options.selectedPudoId=e),dpdMapOpenWidgetMapPopupEl=document.querySelector(p),(g=function(){var e=document.querySelector('input[name="ship_to_different_address"]');if(e&&e.checked){var t=document.querySelector('input[name="shipping_postcode"]');if(t&&(g=t.value),g)return g}var o=document.querySelector('input[name="billing_postcode"]');o&&(g=o.value);if(g)return g;if(g=dpdMapOpenWidgetMapPopupEl.getAttribute("data-customer-zip"))return g;return""}())&&(o.options.zip=g);var d=dpdMapOpenWidgetMapPopupEl.getAttribute("data-base-country-code");d&&(o.options.country=d);var a=parseInt(dpdMapOpenWidgetMapPopupEl.getAttribute("data-min-weight-in-kg")),r="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-is-eligible-for-alzabox"),i="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-is-eligible-for-slovenska-posta-box");o.options.minWeightInKg=a;var c="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-disallow-shops"),l="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-disallow-lockers"),u="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-disallow-dpd-pickup-stations"),s="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-disallow-sk-post"),y="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-disallow-alza-boxes"),v=["shop","locker"];c&&(v=v.filter((function(e){return"shop"!==e}))),l&&(v=v.filter((function(e){return"locker"!==e}))),o.options.allowedPudoTypes=v;var m=["dpdSkPickupStations","skPost","alzaSlovakia","outsideOfSlovakia"];r&&i||(r||(m=m.filter((function(e){return"alzaSlovakia"!==e}))),i||(m=m.filter((function(e){return"skPost"!==e})))),l||(u&&(m=m.filter((function(e){return"dpdSkPickupStations"!==e}))),s&&(m=m.filter((function(e){return"skPost"!==e}))),y&&(m=m.filter((function(e){return"alzaSlovakia"!==e})))),o.options.allowedLockerTypes=m;var _=[],w="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-is-cod-required"),b="true"===dpdMapOpenWidgetMapPopupEl.getAttribute("data-is-card-payment-required");(w||b)&&(w&&_.push("cod"),b&&_.push("cardPayment")),o.options.requiredServices=_,o.attach(h).then((function(e){f({id:e.id,name:e.name,street:e.street,houseno:e.houseno,zip:e.zip,city:e.city,countryCode:e.countryCode,maxweight:e.maxWeightInKg,cod:!(!e.services||!e.services.includes("cod")),card:!(!e.services||!e.services.includes("cardPayment")),isEligibleForAlzabox:r,isEligibleForSlovenskaPostaBox:i}),P()})).catch((function(e){P()}))}}function P(){t.classList.remove("active"),o&&o.close&&o.close()}return m=function(){w()},"complete"===document.readyState||"interactive"===document.readyState?setTimeout(m,1):document.addEventListener("DOMContentLoaded",m),{openPopup:b}}()})();
//# sourceMappingURL=dpd-parcelshop-map-widget.js.map